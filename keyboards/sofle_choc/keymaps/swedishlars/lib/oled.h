#pragma once

#include "quantum.h"

// TODO only used in one place, rm and define directly in func
/* #define OLED_RENDER_KEYLOGGER "KEY LOGGER" */

#define OLED_KEYLOG_LENGTH 11

// global to check if oled startup logo anim is done
extern bool oled_startup_done;

// timer for hiding oled help
extern uint16_t oled_help_timer;

// TODO timer for oled blinking text

// global used to check if keylogger is enabled
extern bool oled_keylogger_enabled;

uint32_t oled_rotate(uint32_t trigger_time, void *cb_arg);

bool process_record_user_oled(uint16_t keycode, keyrecord_t *record); 

void oled_render_logo(void);
void oled_render_right(void);
void oled_render_left(void);
void oled_render_boot(bool bootloader);

// TODO backslash does not count as a char
static const char PROGMEM keycode_to_name[256][OLED_KEYLOG_LENGTH] = {
//   0           1            2            3            4            5            6            7            8            9         Raw code 
//  ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------
    "          ","          ","          ","          "," a        "," b        "," c        "," d        "," e        "," f        ",  // 0-9
    " g        "," h        "," i        "," j        "," k        "," l        "," m        "," n        "," o        "," p        ",  // 10-19
    " q        "," r        "," s        "," t        "," u        "," v        "," w        "," x        "," y        "," z        ",  // 20-29
    " 1        "," 2        "," 3        "," 4        "," 5        "," 6        "," 7        "," 8        "," 9        "," 0        ",  // 30-39
    "Enter     "," Escape   ","Back Space"," Tab      ","Space     "," -        "," =        "," [        "," ]        "," \\       ",  // 40-49
    " #        "," ;        "," \'       "," `        "," ,        "," .        "," /        ","128       "," F1       "," F2       ",  // 50-59
    " F3       "," F4       "," F5       "," F6       "," F7       "," F8       "," F9       "," F10      "," F11      "," F12      ",  // 60-69
    "Print Scrn","Scroll Lck","Play/Pause","Insert    "," Home     ","Page Up   "," Delete   "," End      ","Page Down ","Right     ",  // 70-79
    " Left     "," Down     "," Up       ","Num Lock  ","/         "," *        "," -        "," +        ","Enter     "," 1        ",  // 80-89
    " 2        "," 3        "," 4        "," 5        "," 6        "," 7        "," 8        "," 9        "," 0        "," .        ",  // 90-99
    " \\       ","App Menu  ","Mac Power "," =        "," F13      "," F14      "," F15      "," F16      "," F17      "," F18      ",  // 100-109
    " F19      "," F20      "," F21      "," F22      "," F23      "," F24      ","          ","          ","          ","          ",  // 110-119
    "          ","          ","          ","          ","          ","          ","          ","          ","          ","          ",  // 120-129
    "          ","          ","          ","          ","          ","          ","          ","          ","          ","          ",  // 130-139
    "          ","          ","          ","          ","          ","          ","          ","          ","          ","          ",  // 140-149
    "          ","          ","          ","          ","          ","          ","          ","          ","          ","          ",  // 150-159
    "          ","          ","          ","          ","          ","Sys Power ","Sys Sleep ","Sys Wake  ","Mute      ","Vol Up    ",  // 160-169
    "Vol Down  ","Next Track","Prev Track","          ","Play/Pause","          ","          ","          ","          ","          ",  // 170-179
    "          ","          ","          ","          ","          ","          ","          ","          ","          ","          ",  // 180-189
    "          ","          ","          ","MissionCtl","Launch Pad","          ","          ","          ","          ","          ",  // 190- 199
    "          ","          ","          ","          ","0x80      ","0x80      ","0x80      ","0x80      ","0x80      ","L MouseBtn",  // 200-209
    "R MouseBtn","M MouseBtn","MouseBtn 4","MouseBtn 5","0x80      ","0x80      ","0x80      ","Wheel Up  ","Wheel Down","Wheel Left",  // 210-219
    "Wheel Rght","MouseAcc 0","MouseAcc 1","MouseAcc 2","L Control ","L Shift   ","L Alt     ","L Gui     "," R Control","R Shift   ",  // 220-229
    "R Alt     ","R Gui     ","          ","          ","          ","          ","          "," 24       "," 26       "," 24       ",  // 230-239
    "25        ","          ","          ","          ","          ","          ","          ","          ","          "," 24       ",  // 240- 249
    "25        "," 27       "," 26       ","          ","          ","          "                                                       // 250-255
};

static const char PROGMEM shifted_keycode_to_name[101][OLED_KEYLOG_LENGTH] = {
//   0           1            2            3            4            5            6            7            8            9              Raw code 
//   -----     --------     --------     --------     --------     --------     --------     --------     --------     -------------- 
    "          ","          ","          ","          "," A        "," B        "," C        "," D        "," E        "," F        ",  // 0-9
    " G        "," H        "," I        "," J        "," K        "," L        "," M        "," N        "," O        "," P        ",  // 10-19
    " Q        "," R        "," S        "," T        "," U        "," V        "," W        "," X        "," Y        "," Z        ",  // 20-29
    " !        "," \"       ","Pound     "," $        ","Percent   "," ^        "," &        "," *        "," (        "," )        ",  // 30-39
    "Enter     ","Escape    ","Back Space","Tab       ","Space     "," _        "," +        "," {        "," }        "," |        ",  // 40-49
    " ~        "," :        ","  @       ","Neg Symbol"," <        "," >        "," ?        "," Caps Lock"," F1       "," F2       ",  // 50-59
    " F3       "," F4       "," F5       "," F6       "," F7       "," F8       "," F9       "," F10      "," F11      "," F12      ",  // 60-69
    "Print Scrn","Scroll Lck","Play/Pause","Insert    "," Home     ","Page Up   ","Delete    "," End      ","Page Down ","Right     ",  // 70-79
    " Left     "," Down     "," Up       ","Num Lock  ","/         "," *        "," -        "," +        ","Enter     "," 1        ",  // 80-89
    " 2        "," 3        "," 4        "," 5        "," 6        "," 7        "," 8        "," 9        "," 0        "," .        ",  // 90-99
    " |        ",                                                                                                                       // 100
};

static const char PROGMEM lower_keycode_to_name[30][OLED_KEYLOG_LENGTH] = {
//   0      1       2       3       4       5       6       7            8       9         Raw code 
//   -------------------------------------------------------------     ------------------
    ""          ,""          ,""          ,""          ,""          ,""          ,""          ,"Tmux Term ",""          ,""          ,  // 0-9
    ""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,  // 10-19
    ""          ,""          ,""          ,"Terminal  ",""          ,""          ,""          ,""          ,""          ,""          ,  // 20-29
};

static const char PROGMEM raise_keycode_to_name[90][OLED_KEYLOG_LENGTH] = {
//   0      1       2       3       4       5       6       7       8       9         Raw code 
//   -------------------------------------------------------------------------------
    ""          ,""          ,""          ,""          ,""          ,""          ,"Ctrl + c  ",""          ,""          ,""          ,  // 0-9
    ""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,  // 10-19
    ""          ,""          ,""          ,"Terminal  ",""          ,"Ctrl + v  ",""          ,"Ctrl + x  ",""          ,"Ctrl + z  ",  // 20-29
    ""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,  // 30-39
    ""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,  // 40-49
    ""          ,""          ,""          ,"Neg Symbol",""          ,""          ,""          ,""          ,"Alt + F1  ","Alt + F2  ",  // 50-59
    "Alt + F3  ","Alt + F4  ","Alt + F5  ","Alt + F6  ","Alt + F7  ","Alt + F8  ","Alt + F9  ","Alt + F10 ","Alt + F11 ","Alt + F12 ",  // 60-69
    ""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,""          ,"Alt+Right ",  // 70-79
    "Alt+Left  ","Alt+Down  ","Alt+Up    ",""          ,""          ,""          ,""          ,""          ,""          ,""          ,  // 80-89
};

// TODO add numpad, mouse & setup layers


// 128x32 oled logo
/* static const char PROGMEM qmk_logo[] = { */
/*     0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87, 0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F, 0x90, 0x91, 0x92, 0x93, 0x94, */
/*     0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7, 0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF, 0xB0, 0xB1, 0xB2, 0xB3, 0xB4, */
/*     0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7, 0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF, 0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0x00 */
/* }; */

// 64x128 oled logo
/*
static const char PROGMEM qmk_logo[] = {
    0,  0,  0,  0,  0,128,192,192,254,192,192,254,192,192,192,192,254,254,192,192,192,192,254,192,192,254,192,192,128,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,224,224,224, 32, 32, 32, 32, 32,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 18, 18, 18, 18, 18,255,255,255,
    255,255,255,  1,255,255,255,255,  1,255,255,255,255,255,  1,  3,255,255,255,255,255, 18, 18, 18, 18, 18,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    255,255,255,  4,  4,  4,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,134,134,134,134,134,255,255,255,255,255,255,192,159, 63,127,127,
    0,127,127,127, 63,159,192,224,255,255,255,255,255,134,134,134,134,134,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,177,177,  1,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  4,  4,  4,  4,  4, 31, 63, 63,255, 63, 63,255, 63, 63, 63, 63,248,255, 63, 63, 63, 63,255, 63, 
    63,255, 63, 63, 31,  4,  4,  4,  4,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  3,  0,  0,  0,  0,  3,  3,  0,  0,  0,  0,  3,  0,  0,  3,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,192,192,192,192, 64, 64,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,127,127,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,224,224,224, 96,
    96,224,224,192, 96, 96, 96,224,224,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,248,252, 62, 30, 14, 14, 14,
    14, 14, 62,252,248,192,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 63, 63,  0,  0,  0,  0, 63, 63,  0,  0,  0, 63,
    63, 63,  0,  0,  0,  0,  0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 15, 31, 62, 56, 56, 56, 56,120,248,222,159, 15,  1,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 16,240,240,128,128,240,240,240,192,  0,240,240, 48,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,128,128,128,  0,  0,  0,  0,  0,128,128,128,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  1, 31, 31, 31, 15,  0,  7, 31, 31, 31,  3,  0,  0,  0,  0,  0,  0,  0,  0, 0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,255,255,255, 15,127,248,224,240,252, 63,  7,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    200,200,200,200, 88,248,248,224,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 15, 15, 15,
    0,  0,  1,  1,  1,  0,  0,  0, 15, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 15, 15, 12, 12, 12, 15, 15, 15,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,224,224,224,  0,  0,128,192,224,224, 96, 32,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,252,252, 60, 12,  4,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,255, 30, 63,119,227,193,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  7,  7,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  3,  3,  0,  0,  0,  0,  1,  3,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0, 96,252,254, 38, 38, 38, 38, 62, 60,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  3,  3,  3,
    3,  3,  3,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0,
};
*/

static const char PROGMEM qmk_logo[] = {
        255,  1,  1,  1,225, 97, 33, 63,  1, 63, 63,  1, 63, 32, 32, 63,  1,  1, 63, 32, 32, 63,  1, 63, 63,  1, 63, 33, 97,225,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,241, 17, 17,209, 81, 81, 81, 81, 81,113,  1,  1,  1,  1,  1,  1,  1,  1,  1,255,255, 45, 45, 45, 45,237,  0,  0,  0,  0,  0,  0,254,  0,  0,  0,  0,254,  0,  0,  0,  0,  0,254,252,  0,  0,  0,  0,  0,237, 45, 45, 45, 45, 63,  0,  0,  0,  0,  0,  0,  0,  0,255,  0,  0,251, 10, 10, 10, 10, 14,  0,  0,  0,  0,  0,  0,  0,  0,  0, 
        0,255,255,121,121,121,121,121,  0,  0,  0,  0,  0,  0, 63, 96,192,128,128,255,128,128,128,192, 96, 63, 31,  0,  0,  0,  0,  0,121, 73, 73, 73, 73,207,  0,  0,  0,  0,  0,  0,  0,  0,243,146,146,243,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,251, 11, 11, 11,123, 96, 64,192,  0,192,192,  0,192, 64, 64,192,  7,  0,192, 64, 64,192,  0,192,192,  0,192, 64, 96,123, 11, 11, 11, 11, 15,  0,  0,  0,  0,  0,  0,  0,  0,255,  0,  0,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 
        0,255,255,255,  0,  0,  0,  0,  0,  0,  7,  4,  7,  7,  4,  7,  0,  0,  7,  4,  4,  7,  0,  0,  7,  4,  7,  7,  4,  7,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,227, 34,226, 99, 32,160,160,224,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,128,128,252,  7,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 
        0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,248,  8, 24, 48,144,144, 48, 32, 96, 48,144,208, 16, 48,224,  0,  0,  0,  0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,240, 28,  6,226,243,249, 25,  9, 25, 51,227,  6, 30,252,248,224,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,127, 64, 64,127,  1,  1,127, 64, 64,127,  1,127, 64, 64,127,  0,  0,  0, 
        0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  7, 28, 48, 35,103, 79, 76,200,140,  6, 51,112,124,255,207,  3,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 56,232,  8, 56,224,240, 24,200, 24,240,224, 56,  8,232, 56,  0,  0,  0,  0,  0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,192, 64, 64, 64,192,192,128,  0,  1,129,193, 65, 65,193,193,192,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, 15, 56, 35, 33, 60, 15, 60, 33, 35, 56, 15,  1,  0,  0,  0,  0,  0, 
        0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,  0,  0,254,120,195, 15, 62, 14,131,248,254,  0,  0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,128,206,106, 42,170,170,186,178,  6, 60,224,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 31, 16, 16, 31,  0,  1,  3,  2,  3,  1,  0, 31, 16, 16, 31, 31, 15,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 31, 24, 48, 39, 45, 44, 38, 51, 24, 16, 31,  0,  0,  0,  0,  0,  0,  0,  0, 
        0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,240, 16, 16,240,240,128,192, 96, 48,144,208,208,240,112, 32,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,254,  2, 14,198,114, 26, 10, 14,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,255,  0,  0,227,227,201,156, 62,127,255,243,193,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 15,  8,136,135,128,128,128,128,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 
        0,255,255,255,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  7,  4,  4,  7,  7,  0,  1,  3,  6,  4,  5,  5,  7,  7,  6,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,254,  3,  9,236,166, 38,172,169,163,190,  0,  0,  0,  0,  0,  0,  0,  0, 
        0,255,255,255,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,192,193,195,198,196,197,197,197,196,198,195,192,192,192,192,192,192,192,192,192,255,255,
};


